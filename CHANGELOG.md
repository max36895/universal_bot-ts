# История изменений

Все значимые изменения в проекте umbot документируются в этом файле.
Формат основан на [Keep a CHANGELOG](http://keepachangelog.com/).


## [2.2.x] - 2025-16-11

### Добавлено

- Возможность в logger указать метрику.

### Обновлено

- Ошибки во время работы приложения записываются как ошибки, а не как обычные логи

### Исправлено

- Архитектурная проблема, из-за которой приложение могло работать не корректно 

## [2.1.0] - 2025-19-10

### Добавлено

- Добавлена поддержка MAX
- Метод textReplace для Text. Метод корректно заменяет весь необходимый текст
- Добавлено ограничение для кэширования регулярных выражений
- Добавлена возможность задать свою функцию для логирования `Bot.set`
- Добавлен класс `Preload`, который позволяет предзагрузить необходимые ресурсы до запуска навыка.
- Добавлена возможность указать свой httpClient через bot.getAppContext().httpClient.
- Добавлена возможность в slots добавить честное регулярное выражение(/hi/i new RegExp('hi''))
- Добавлен benchmark для проверки производительности библиотеки
- В platformParams добавлено поле empty_text, этот текст будет выведен пользователю, если нужная команда не была
  найдена.
- Если в addCommand передать название команды как FALLBACK_COMMAND, то команда будет выполнена в случае, если не
  получится найти команду для обработки
- Добавлена поддержка middleware

### Обновлено

- Механика настройки приложения. Происходит отказ от использования глобального `mmApp` в пользу готовых механизмов в
  `Bot.setLogger`
- Методы initConfig и initParams помечены как deprecated. Вместо них стоит использовать setAppConfig и
  setPlatformParams.
- Небольшая оптимизация производительности
- Написано чуть больше тестов, за счет чего поднялся coverage
- Обновился eslint до актуальной версии
- BotController не обязательно задавать, если все можно сделать за счет `bot.addCommand`
- При записи логов в файл, все секреты маскируются
- Поиск опасных регулярных выражений(ReDos) и интентах
- Сохранение логов стало асинхронной операцией
- Произведена микрооптимизация

### Исправлено

- Ошибка при указании в tts нескольких звуков
- Ошибки некорректной работы некоторых приложений
- Ошибки в cli
- Исправлена ошибка, когда поиск по регулярному выражению мог возвращать не корректный результат
- Ошибки с некорректным отображением документации
- Ошибки с некорректной отправкой запроса к платформе
- Ошибка когда benchmark мог упасть, также доработан вывод результата

## [2.0.0] - 2025-05-08

### Добавлено

- prettier для стилизации
- Добавлен eslint
- В cli добавлена возможность сгенерировать .env файл
- Добавлено форматирование сгенерированного cli проекта через prettier

### Обновлено

- Удалена поддержка старого подключения через micro
- Работа некоторых компонентов
- Поменялась логика работы модели
- Поменялась utm метка в ссылках по умолчанию. Раньше было Yandex_Alisa стало umBot
- Произведена оптимизация работы некоторых утилит
- Поменялось API для методов работы с файлами
- Добавлена новая логика для регистрации обрабатываем команд. Сейчас помимо добавления команды в mmApp.setParam, можно
  передать ее в mmApp.addCommand(commandName: string, slots: string, cb: (userCommand: string, botController?:
  BotController) => {})
- Для удаления ранее добавленной команды можно вызвать mmApp.removeCommand(commandName: string)

### Исправлено

- Документация некоторых компонентов
- Опечатки в документации
- Ошибки в cli

## [1.1.8] - 2022-10-06

### Добавлено

- Unit тесты на jest
- В консольный скрипт добавлена возможность указывать режим работы приложения.
- Добавлена возможность указывать режим работы для приложения. Режим разработки отличается от релизного тем, что в нем
  выводятся все сообщения об ошибках в консоль.

### Обновлено

- Структура проекта. Некоторые классы и компоненты переехали в другие каталоги
  ** `Text` из components переехал в `utils`
  ** Компоненты отвечающие за обработку и возврат ответа для конкретной платформы приложения переехали в `platforms`
- Найденные в ходе перемещения ошибки
- Метод `nav` в `components:Navigation `переименован в `getPageElements`
- Описание некоторых опций

### Исправлено

- Циклические зависимость
- Документация некоторых компонентов
- При установке через npm не корректно работала подсветка и подсказки
- Удалено все лишнее из `dist`
- Большие методы разбиты на более мелкие
- Поправлена автодокументация

## [1.1.6] - 2022-08-14

### Добавлено

- Проект добавлен в `npm`

### Обновлено

- Немного изменено имя

## [1.1.5] - 2022-08-14

### Исправлено

- Произведен мини рефакторинг проекта
- Недочеты в консольном скрипте

### Добавлено

- Возможность оценить приложение
- Новое состояние на приложении, которое позволяет понять какое действие было выполнено пользователем BotController:
  userEvents
- В BotController удалено состояние isAuthSuccess, место него стоит использовать userEvents.auth.status
- Добавлена проверка на установку логики приложения

### Обновлено

- Название некоторых методов, которые в название содержали нижнее подчеркивание
- Описание некоторых классов и их свойств

## [1.1.4] - 2022-05-01

### Исправлено

- Произведен рефакторинг проекта, лишнее удалено
- Ошибки с типизацией
- Ошибки с производительностью
- Ошибки стабильности

### Добавлено

- Новые интерфейсы
- Новые правила сборки проекта, из-за чего возросла надежность кода
- Новый класс для тестирования приложения. Основной класс запуска приложения, не запускает тестирование.

### Обновлено

- Логика поиска почты. Стало работать быстрее
- Описание некоторых классов и их свойств

## [1.1.3] - 2021-07-17

### Исправлено

- Незначительные ошибки и опечатки
- Произведена оптимизация кода

### Добавлено

- В Text добавлен новый метод isUrl
- Метод run в случае ошибки кидает исключение
- В Request добавлен метод для загрузки файлов на сервер
- run в случае ошибки кидает исключение
- Поддержка локального хранилища в Марусе
- Загрузка изображений и звуков в Марусе

## [1.1.2] - 2021-04-01

### Исправлено

- Ошибка с сохранением данных в SmartApp

## [1.1.1] - 2021-03-30

### Добавлено

- Отслеживание изменений(Changelog)
- Новые Unit тесты
- Консольный скрипт для автоматического создания проекта
- Для карточек добавлена возможность задавать свой шаблон
- Демка, демонстрирующая возможность указания своего обработчика для подключения к бд
- Для Сбер SmartApp была добавлена возможность локального хранения данных(данные сохраняются в бд Сбера)

### Исправлено

- Места, влияющие на производительность
- Интерфейс IModelRes перенесен в интерфейсы
- Поправлена ошибка при работе SmartApp
- Поправлена ошибка с сохранением данных в файл

### Обновлено

- Поменялось логика отображения карточки для SmartApp
- Изменилось имя для проекта для smartApp было smart-app стало smart_app

## [1.1] - 2021-02-23

Более стабильная версия, с исправлением большей части ошибок

### Добавлено

- Возможность задания своего контроллера для подключения в бд.
- Вспомогательный класс, хранящий данные для запросов к базе данных. Который также способен перевести строку в
  корректный для запроса формат

### Обновлено

- Изменена логика работы с базой данных
- При работе с текстом, а именно с поиском вхождения, поменялась логика поиска. Раньше поиск осуществлялся через
  регулярное выражение, в текущей версии через indexOf

### Исправлено

- Все найденные ошибки и замечания

## [1.0] - 2020-12-25

Появление стабильной версии, которую можно использовать в проекте

### Добавлено

- Поддержка Маруси и Сбер SmartApp
- Документация
- Unit тесты

### Исправлено

- Найденные ошибки

## [0.9-beta] - 2020-11-04

Создание бета-версии

[master]: https://github.com/max36895/universal_bot-ts/compare/v2.1.0...master
[2.1.0]: https://github.com/max36895/universal_bot-ts/compare/v2.0.0...v2.1.0
[2.0.0]: https://github.com/max36895/universal_bot-ts/compare/v1.1.8...v2.0.0
[1.1.8]: https://github.com/max36895/universal_bot-ts/compare/v1.1.6...v1.1.8
[1.1.6]: https://github.com/max36895/universal_bot-ts/compare/v1.1.5...v1.1.6
[1.1.5]: https://github.com/max36895/universal_bot-ts/compare/v1.1.4...v1.1.5
[1.1.4]: https://github.com/max36895/universal_bot-ts/compare/v1.1.3...v1.1.4
[1.1.3]: https://github.com/max36895/universal_bot-ts/compare/v1.1.2...v1.1.3
[1.1.2]: https://github.com/max36895/universal_bot-ts/compare/v1.1.1...v1.1.2
[1.1.1]: https://github.com/max36895/universal_bot-ts/compare/v1.1.0...v1.1.1
[1.1.0]: https://github.com/max36895/universal_bot-ts/compare/v1.0.0...v1.1.0
[1.0.0]: https://github.com/max36895/universal_bot-ts/compare/v0.9.0-beta...v1.0.0
[0.9.0-beta]: https://github.com/max36895/universal_bot-ts/releases/tag/v0.9.0-beta
