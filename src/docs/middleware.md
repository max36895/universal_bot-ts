# Middleware

`umbot` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **middleware –≤ —Å—Ç–∏–ª–µ `telegraf` –∏ `vk-io`** ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è **–¥–æ –∑–∞–ø—É—Å–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** (`BotController.action`).

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```ts
// –ì–ª–æ–±–∞–ª—å–Ω—ã–π middleware (–¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º)
bot.use(async (ctx, next) => {
  console.log('–ó–∞–ø—Ä–æ—Å:', ctx.appContext.appType);
  await next(); // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–∑–≤–∞—Ç—å next() –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è
});

// –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
bot.use('alisa', async (ctx, next) => {
  if (!ctx.appContext.requestObject?.session?.user_id) {
    ctx.text = '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å';
    ctx.isEnd = true;
    // next() –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è ‚Üí action() –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
    return;
  }
  await next();
});
```
## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- Middleware –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π BotController (—Å text, isEnd, userData –∏ —Ç.–¥.).
- –ï—Å–ª–∏ –≤—ã –Ω–µ –≤—ã–∑–æ–≤–µ—Ç–µ next(), —Ç–æ action() –Ω–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
- –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: —Å–Ω–∞—á–∞–ª–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ, –ø–æ—Ç–æ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ middleware.